 #FROM instructure/rvm:latest
 +#FROM adgud2/ruby-rvm:latest
 +#FROM hypriot/rpi-ruby:latest
 +#FROM resin/rpi-raspbian
 +FROM resin/armv7hf-debian

 MAINTAINER Thiago Soares <thiagosoarescruz0@gmail.com>
 
 RUN useradd -m docker && echo "docker:docker" | chpasswd && adduser docker sudo
 
 USER docker
 +#RUN docker ALL = NOPASSWD: /sbin/poweroff, /sbin/start, /sbin/stop
 
 # Install MySQL client
 RUN apt-get update -yq mysql-client
 RUN apt-get autoremove -y
 RUN rm -rf /var/lib/apt/lists/*
 
 # Install Build essentials
 RUN apt-get update -yq 
 RUN apt-get -qy install ca-certificates build-essential libpq-dev nodejs-legacy

 RUN apt-get autoremove -y
 
 RUN apt-get install patch ruby-dev zlib1g-dev liblzma-dev liblzma-dev autoconf bison build-essential libssl-dev libyaml-dev libreadline6-dev zlib1g-dev libncurses5-dev libffi-dev libgdbm3 libgdbm-dev
 
 RUN rm -rf /var/lib/apt/lists/*
 
 ###### Testes do RVM
 
 # install RVM, Ruby, and Bundler
 #RUN \curl -L https://get.rvm.io | bash -s stable
 
 RUN /bin/bash -l -c "rvm requirements"
 RUN /bin/bash -l -c "rvm install 2.3.3"
 RUN /bin/bash -l -c "gem install bundler --no-ri --no-rdoc"
 RUN /bin/bash -l -c "apt-get install rubygems"
 
 # Workdir
 RUN mkdir -p /home/app
 
 # Install gems
 ADD Gemfile* /home/app/
 
 #Add Docker path
 ADD docker /home/app/docker/
 
 # Add the Rails app
 ADD . /home/app
  
 # Set some config
 ENV RAILS_LOG_TO_STDOUT true
 
 WORKDIR /home/app
 
 #Run bundle
 #RUN bundle install
 RUN /bin/bash -l -c "bundle install"
 
 #Instalar Ruby por script
 #CMD "docker/install_ruby.sh"

 #RUN bash /docker/bundle.sh

 # Create user and group
 RUN groupadd --gid 9999 app
 RUN useradd --uid 9999 --gid app app
 RUN chown -R app:app /home/app
 
 # Expose app port
 EXPOSE 80 3000
 
 # Save timestamp of image building
 #RUN date -u > BUILD_TIME
 
 # Start up
 #CMD "docker/startup.sh"
 